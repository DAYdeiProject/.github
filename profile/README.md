# DAYdeiRepo
## DAYDEI 배포 링크
🗓️[지금 바로 daydei사이트 방문하기](https://www.daydei.life/)

<p>
  <img src="https://user-images.githubusercontent.com/94800969/232995084-4eb7d3d4-2d75-44af-8921-a28765e2c881.gif">
</p>



## 깃허브 레포

> FE :
[DAYdei FE 깃허브 바로가기](https://github.com/DAYdeiProject/DAYdei_FE.git)


> BE :
[DAYdei BE 깃허브 바로가기](https://github.com/DAYdeiProject/DAYdeiBackRepo)

## 노션

>프로젝트 노션 :
[프로젝트 노션 바로가기](https://shard-velvet-790.notion.site/daydei-258f1b00e93c4c719b92be10e78a3a51)


>원페이지 노션 :
[원페이지 노션 바로가기](https://shard-velvet-790.notion.site/A-4-SA-ae22a288543d455c810012fd6ac9b3a0)

### 팀원

| 이름   | 포지션 | 팀원구분        |             Github              |
| ------ | :----: | --------------- | :-----------------------------: |
| 정다정 |   FE   | 프론트엔드 팀장 | https://github.com/daaaj |
| 김준형 |   FE   | 프론트엔드 팀원 | https://github.com/juninkorea95 |
| 김주희 |   BE   | 백엔드 팀장 |    https://github.com/Jjuhui313     |
| 최정환 |   BE   | 백엔드 팀원 | https://github.com/the1224 |
| 한지윤 |   BE   | 백엔드 팀원 | https://github.com/trueyoon |


## 기술스택 BE

<div> 
  <img src="https://img.shields.io/badge/JAVA-007396?style=for-the-badge&logo=java&logoColor=white">
  <img src="https://img.shields.io/badge/IntelliJIDEA-000000?style=for-the-badge&logo=IntelliJIDEA&logoColor=white">
  <img src="https://img.shields.io/badge/Gradle-02303A?style=for-the-badge&logo=Gradle&logoColor=white">
  <img src="https://img.shields.io/badge/Linux-FCC624?style=for-the-badge&logo=Linux&logoColor=white">
  <img src="https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=Ubuntu&logoColor=white">
  <img src="https://img.shields.io/badge/jsonwebtokens-000000?style=for-the-badge&logo=jsonwebtokens&logoColor=white">
  <img src="https://img.shields.io/badge/SSE-000000?style=for-the-badge&logo=&logoColor=white"/> <br>
  <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white">
  <img src="https://img.shields.io/badge/springsecurity-6DB33F?style=for-the-badge&logo=springsecurity&logoColor=white">
  <img src="https://img.shields.io/badge/AmazonEC2-FF9900?style=for-the-badge&logo=AmazonEC2&logoColor=white"/> 
  <img src="https://img.shields.io/badge/AmazonS3-569A31?style=for-the-badge&logo=AmazonS3&logoColor=white"/>
  <img src="https://img.shields.io/badge/AmazonRDS-527FFF?style=for-the-badge&logo=AmazonRDS&logoColor=white"/> <br>
  <img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
  <img src="https://img.shields.io/badge/jquery-0769AD?style=for-the-badge&logo=jquery&logoColor=white">
  <img src="https://img.shields.io/badge/CODEDEPLOY-181717?style=for-the-badge"/>
  <img src="https://img.shields.io/badge/NGINX-009639?style=for-the-badge&logo=nginx&logoColor=white"/>
  <img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white"/>
  <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"/>
  <img src="https://img.shields.io/badge/GithubActions-2088FF?style=for-the-badge&logo=githubactions&logoColor=white"/>
  <img src="https://img.shields.io/badge/Postman-FF6C37?style=for-the-badge&logo=Postman&logoColor=white"/>
  <img src="https://img.shields.io/badge/Swagger-85EA2D?style=for-the-badge&logo=swagger&logoColor=black"/>
  <img src="https://img.shields.io/badge/Sentry-362D59?style=for-the-badge&logo=sentry&logoColor=white"/>
  <img src="https://img.shields.io/badge/Notion-000000?style=for-the-badge&logo=Notion&logoColor=white"/> 
  <img src="https://img.shields.io/badge/Slack-4A154B?style=for-the-badge&logo=slack&logoColor=white"/>
  <img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white"> 
  <img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> 
  <img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black"> 
  <img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black"> 
  <img src="https://img.shields.io/badge/Redux_Toolkit-764ABC?style=for-the-badge&logo=redux&logoColor=white">
  <img src="https://img.shields.io/badge/Axios-5a2f88?style=for-the-badge&logo=axios&logoColor=white">
  <img src="https://img.shields.io/badge/Styled_Components-DB7093?style=for-the-badge&logo=styled-components&logoColor=white">
  <img src="https://img.shields.io/badge/react--router--dom-CA4245?style=for-the-badge&logo=react-router-dom&logoColor=white">
</div>

## 프로젝트 기능

### 😊 회원가입  / 카카오 로그인

> 개인 캘린더 기능 구현을 위해 회원가입과 로그인을 구현하였습니다.
일반 로그인 뿐 아니라 OAuth2를 이용하여 회원가입 없이 카카오 로그인도 가능합니다.!
<p>
  <img src="https://user-images.githubusercontent.com/86552492/232414598-6bd1935b-2a97-4d8e-9dd0-fe5cc8fedc0a.png" />
  <img src="https://user-images.githubusercontent.com/86552492/232414742-7e56f6a9-9442-4216-8492-d022b4419856.png"/> 
</p>


### ❤️ 친구 신청 / 카카오 친구 연동

> 친구 관계를 설정하고 싶은 사용자에게 친구 신청을 보낼 수 있습니다.
카카오 로그인 접속자의 경우, 친구 탭에서 카카오 친구 연동을 통해
DAYDEI 서비스를 이용 중인 카카오 친구에게 일괄 친구 신청을 보낼 수 있습니다.
이용자 프로필에서 나와 함께 아는 친구가 몇 명인지 확인 할 수 있습니다.
<p>
  <img src="https://user-images.githubusercontent.com/122579951/233258184-4945b9c7-89b7-4b9c-a46a-e8db542e652f.png">
  <img src="https://user-images.githubusercontent.com/122579951/233258195-50fba0b6-3721-4afa-963d-051276aa7574.png">
</p>

### ✏️ 일정 CRUD

> 캘린더에서 희망 날짜에 일정을 등록할 수 있습니다.
일정에 친구를 초대할 수 있고, 초대받은 친구가 일정을 수락하면 친구의 캘린더에도 일정이 등록됩니다.
일정에 사진을 최대 3장 첨부할 수 있습니다.
일정의 공개 범위를 선택할 수 있습니다.
‘전체공개(스크랩가능)’을 선택할 경우, 나를 구독한 이용자의 캘린더에 해당 일정을 표시할 수 있습니다.
> 

<div>
 <img src="https://user-images.githubusercontent.com/86552492/232416137-a6488b2c-a8be-4e5d-91f3-125e148478a5.png"/> 
 <img src="https://user-images.githubusercontent.com/86552492/232416274-68b1403d-8669-45dd-8dcf-691d2f852055.png"/> 
 <img src="https://user-images.githubusercontent.com/122579951/233257295-56d72102-96d4-4085-8478-6184edaa8b3e.png"/> 
</div>

### 🌟 구독하기

> 원하는 이용자를 구독할 수 있습니다.
구독한 이용자가 ‘전체공개(스크랩가능)’ 범위로 등록한 일정을 모두 내 캘린더에 표시할 수 있습니다.
직접 작성한 일정이 아닌, 구독을 통해 내 캘린더에 표시된 일정은 모두 회색으로 표시됩니다.
구독 계정 별로 표시/숨김 설정을 통해 원하는 구독 계정의 일정만 표시할 수 있습니다.
> 
<div>
 <img src="https://user-images.githubusercontent.com/51226340/232831456-9ea82050-0cb8-4d4b-91d0-3a2a986b0227.jpg">
 <img src = "https://user-images.githubusercontent.com/86552492/232415618-d3563e0c-53f1-4544-bce3-2ff95ff5adc6.png"/>
</div>

### 🔔 실시간 알림

> 친구 신청, 친구 승인, 구독, 일정 초대, 임박한 일정 등 각종 알림을 실시간으로 받아볼 수 있습니다.
> 
<div>
  <img src = "https://user-images.githubusercontent.com/86552492/232415166-6d26877b-d2e5-41ed-b996-b1bb0bd0c3a3.png"/>
  <img src = "https://user-images.githubusercontent.com/122579951/233256488-39272d6b-c517-43ec-897b-2ce0e296a862.png" />
</div>

### 🔍 회원 검색

> 찾아보기 탭에서 카테고리별로 이용자들 목록을 살펴볼 수 있습니다.
원하는 이용자를 친구 신청하거나 구독할 수 있습니다.
프로필을 눌러 캘린더를 구경할 수 있습니다.
> 

<div>
  <img src="https://user-images.githubusercontent.com/51226340/232833946-89346709-5d67-49f0-b073-2ce014cdeb49.jpg">
</div>

## 적용 기술

### ◻ Swagger

> 프론트엔드와 정확하고 원활한 소통을 위해 스웨거를 도입하여 적용했습니다.
> 

### ◻ CI/CD

> 빌드와 배포를 효율적으로 하기 위해 CI/CD를 구축했습니다
> 

### ◻ SSE

> 실시간 알림을 위해 SSE를 구현했습니다
> 

### ◻ Sentry

> log 확인의 접근성을 높이기 위해 Sentry를 적용했습니다
> 

### ◻ SSL, Nginx

> 사이트의 보안을 위해 SSL과 Nginx로 https를 적용하였습니다.
> 

### ◻ OAuth2

> 서비스 접근성을 높이기 위해 간편한 소셜로그인을 구현했습니다
> 

### ◻ S3

> 이미지 데이터를 관리하기 위해 S3를 사용했습니다
> 

## 🚨 Trouble Shooting 

[FE] 카카오톡 친구 연동하기 진행 시 토큰 이슈

> 문제
> 
> - 카카오톡 친구 연동 api 사용시 로그인한 유저의 token과 카카오톡 redirect uri에서 받은 code를 서버에 보내고 response에 로그인한 유저의 token이 와야하는데 길이가 짧은 token이 계속 왔다. 그래서 해당 유저의 정보를 불러오지 못하는 에러가 발생하였다.

> 시도
> 
> - 값이 제대로 전달 안되는 문제일까봐 일일이 콘솔 찍어가며 값이 제대로 들어가는지 확인하였다. 통신도 잘 되었고 api에 필요한 값이 제대로 보내지고 있는게 확인되었다. 하지만 여전히 짧은 token이 반환되고 있었다.

> 해결
> 
> - 카카오톡 로그인시에는 token이 제대로 반환되었기 때문에 친구 연동 클릭시 다시 카카오톡 로그인을 하는 로직으로 수정하였다.

- **[FE] formData 서버로 전달 시 맞지 않는 형식 이슈**
    
    > 문제
    > 
    > - 프로필 수정시 정보를 서버에 보낼때 형식이 이미지는 multipart/form-data, 다른 정보는 application/json 형식으로 보내야 했다. 그래서 formData 안에 정보 넣고 header에 "Content-Type": "multipart/form-data" 로 지정하고 요청했지만 400에러가 떴다. 
    
    > 시도
    > 
    > - 이전에는 string 값을 formData로 보낼때 key, value 형식에 맞게만 작성하면 서버에 잘 전달되었다. 그래서 이번에도 그렇게 하고 있었지만 json 형식으로 따로 지정을 해줘야된다고 해서 JSON.stringify로 감싼 후 formData로 보내봤지만 또 400에러가 떴다.
    
    > 해결
    > 
    > - 팀원분이 Blob을 이용하여 보내면 된다고 해서, blob 객체 생성 후 JSON.stringify로 서버로 요청하니깐 해결 되었다.

- **[FE] 생일 입력 BOX 형식 이슈**
    
    > 문제
    > 
    > - 본래 회원 가입 페이지에서 생일 정보는 사용자가 직접 태어난 달과 날짜를 네자리 수로 적어 Input box에 적어 제출하도록 구현했다. 위와 같은 방식의 문제점은 생일의 형식에 벗어나는 숫자 (ex : 9999 / 0000)를 입력해도 회원가입이 허용된다는 점이었다.
    
    > 시도
    > 
    > - 첫 시도로는 기존의 Input box 형식을 유지하되, 입력값의 validation을 적용하려는 방향으로 잡았다. 하지만 이러한 방향은 입력값에 대한 조건을 다소 복잡한 방식으로 줘야했던 만큼 효율적이지 않았다.
    
    > 해결
    > 
    > - 값을 입력하여 전달하는 방식에는 input 뿐만 아니라 select이 있다는 것을 발견하고 적용했다.

<InputInnerWrap>

<select class="box" id="birth-month" onChange={handleMonthChange}>

<option value="">월</option>

{Array.from({ length: 12 }, (_, index) => {

const monthValue = (index + 1).toString().padStart(2, "0");

return <option value={monthValue}>{monthValue}</option>;

})}

</select>

<select class="box" id="birth-day" onChange={handleDayChange}>

<option value="">일</option>

{Array.from({ length: 12 }, (_, index) => {

const monthValue = (index + 1).toString().padStart(2, "0");

return <option value={monthValue}>{monthValue}</option>;

})}

</select>

</InputInnerWrap>

BE
<br>

- 1. SSL 인증서
    - 문제 : 
    SSL 인증서를 생성하는 과정에서 `- the following errors were reported by the server:` 에러 발생
    - 시도 : 
    nginx와 certbot 완전 삭제 후 다시 진행하였으나 같은 오류 발생
    - 해결 : 
    인스턴스 재생성 후 설정되어 있는 PortForwarding 모두 삭제 후 다시 진행하여 정상적으로 인증서 생성
  
  <br>
- 2. SSL+SSE HTTP 프로토콜 버전 이슈
    - 문제 : 
    SSL 적용 후 클라이언트 console에 다음과 같은 에러 발생
    **`net::ERR_INCOMPLETE_CHUNKED_ENCODING`**
    - 시도 : 
    검색 결과,
    nginx 사용 시, HTTP 프로토콜 버전 1.0으로 자동 설정되며
    1.0 버전에서는 SSE 연결 유지가 불가능하기 때문에
    해당 오류가 발생하는 것으로 확인
    - 해결 : 
    nginx conf파일에
    HTTP를 1.1로 설정해주기 위해 server블록에 다음을 추가해주어야 했다.
    `proxy_set_header Connection '';`
    `proxy_http_version 1.1;`
    또한 연결 시간이 기본 1분으로 설정되기 때문에 연결 시간을 늘리고자 다음 설정도 추가해주었더니 해당 에러는 더 이상 뜨지 않았다.
    `proxy_read_timeout 3600s`
    `proxy_send_timeout 3600s`

## 🌐 Architecture

<div>
  <img src = "https://user-images.githubusercontent.com/122579951/233255906-0cf29388-f3df-47ee-85d4-ded35f562e5e.png">
</div>

## 📋 ERD Diagram

<div>
  <img src="https://user-images.githubusercontent.com/94800969/233273683-294ccc97-b8d8-4dc2-bec1-1bde4a3a78b0.JPG">
</div>


## Thank You
<p>
  <img src="https://user-images.githubusercontent.com/51226340/232444605-f65642c7-5bfe-4457-8f97-2956fd17edb1.png">
</p>
